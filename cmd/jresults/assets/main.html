<html>
  <head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/taucharts/latest/tauCharts.min.css">
  </head>
  <body class="container">
    <h1>JMeter results from {{ .StartTime.Format "Jan 02, 2006 15:04:05 EST" }}</h1>
    <table class="table table-striped table-bordered table-hover table-condensed table-responsive">
      <thead>
        <tr>
          <th>Label</th>
          <th>Samples</th>
          <th>Mean</th>
          <th>Standard Deviation</th>
          <th>Median</th>
          <th>95 Percentile</th>
        </tr>
      </thead>
      <tbody>
        {{ range .StatResults }}
        <tr>
          <td>{{- .Label }}</td>
          <td>{{- .Samples }}</td>
          <td>{{- .Mean }}</td>
          <td>{{- .StandardDeviation }}</td>
          <td>{{- .Median }}</td>
          <td>{{- .Percent95 }}</td>
        </tr>
        {{ end  }}
      </tbody>
    </table>
    <div id="chart"></div>
    <script src="//cdn.jsdelivr.net/d3js/latest/d3.min.js" charset="utf-8"></script>
    <script src="//cdn.jsdelivr.net/underscorejs/latest/underscore-min.js" type="text/javascript"></script>
    <script src="//cdn.jsdelivr.net/taucharts/latest/tauCharts.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    var jsonData = {{ .StatResultsJSON }};
     var startTime = {{ .StartTime.Unix }};
     var dataRaw = JSON.parse(jsonData);
     var chartData = [];
     _.each(dataRaw, function(jstat) {
         _.each(jstat.Elapsed, function(val, i) {
           /* var d = new Date(0);*/
           var row = {type: jstat.Label, 'elapsed': (val/1000.0), 'time': ((jstat.TimeStamps[i] - (startTime*1000))/1000)};
           chartData.push(row);
         });
     });

     var chart = new tauCharts.Chart({
       data: chartData,
       type: 'scatterplot',
       x: 'time',
       y: 'elapsed',
       color: 'type', // there will be two lines with different colors on the chart
       guide: {
         x: {label: {text: 'Relative Time Since Start (secords)', padding: 35}, padding: 20},
         y: {label: 'Response Time (seconds)', padding: 20},
         showGridLines: 'xy'
       },
       plugins: [
         tauCharts.api.plugins.get('tooltip')()
       ]
     });

     chart.renderTo('#chart');
    </script>
  </body>
</html>
